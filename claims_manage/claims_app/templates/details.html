<div class="row row3" x-data="{}">
    <template x-if="$store.patientData.selectedPatient">
        <div class="card-medical">
            <div class="card-header">
                <h3 x-text="$store.patientData.selectedPatient?.patient_name" class="patient-name"></h3>
                <span x-text="$store.patientData.selectedPatient?.status" 
                x-bind:class="'s ' + $store.patientData.selectedPatient?.status.toLowerCase().replace(' ', '-')"
                ></span>
            </div>

            <div class="claim-info">
                <strong>Claim ID:</strong> <span x-text="$store.patientData.selectedPatient?.id"></span><br>
                <strong>Discharge:</strong> <span x-text="$store.patientData.selectedPatient?.discharge_date"></span>
            </div>

            <div class="financial-summary">
                <div class="amount-card">
                    <div class="amount-value billed">
                        <span x-text="formatCurrency($store.patientData.selectedPatient?.billed_amount)"></span>
                    </div>
                    <div class="amount-label">Billed</div>
                </div>
                <div class="amount-card">
                    <div class="amount-value paid-info">
                        <span x-text="formatCurrency($store.patientData.selectedPatient?.paid_amount)"></span>
                    </div>
                    <div class="amount-label">Paid</div>
                </div>
            </div>

            <div class="insurer-info">
                <strong>Insurer:</strong> <span x-text="$store.patientData.selectedPatient?.insurer_name"></span>
            </div>
            
            <template x-if="$store.patientData.additionalDetails && !$store.patientData.loadingDetails">
                <div class="insurer-info">
                    <strong>CPT Codes:</strong> <span x-text="$store.patientData.additionalDetails.cpt_codes || 'N/A'"></span>
                </div>
            </template>
            
            <template x-if="$store.patientData.loadingDetails">
                <div class="insurer-info">
                    <strong>CPT Codes:</strong> <span>Loading...</span>
                </div>
            </template>
            
            <template x-if="$store.patientData.additionalDetails && !$store.patientData.loadingDetails">
                <div class="issue-alert" style="margin-top: 0px">
                    <strong>Denial Reason:</strong>
                    <small x-text="$store.patientData.additionalDetails.denial_reason || 'N/A'"></small>
                </div>
            </template>
        </div>
    </template>
    
    <!-- Placeholder for the details card -->
    <template x-if="!$store.patientData.selectedPatient">
        <div class="card-medical">
            <h3 class="card-header">Choose a claim from the table</h3>
        </div>
    </template>
    
    <div class="card-notes">
        <div class="notes-section">
            <div class="section-header">
                <i class="fas fa-sticky-note"></i>
                <h4>Notes & Annotations</h4>
            </div>
            
            <div class="note-item admin-note">
                <div class="note-header">
                    <span class="note-type">Admin Note</span>
                    <span class="note-time">2 days ago</span>
                </div>
                <p class="note-content">Requires additional medical records for processing. Contacted provider.</p>
            </div>
            
            <div class="note-item system-flag">
                <div class="note-header">
                    <span class="note-type b">System Flag</span>
                    <span class="note-time">1 week ago</span>
                </div>
                <p class="note-content">Potential underpayment detected - review recommended.</p>
            </div>
        </div>
        
        <div class="actions-section">
            <div class="section-header">
                <h4>Quick Actions</h4>
            </div>
            
            <div class="action-buttons">
                <button class="action-btn">
                    <i class="fas fa-flag"></i>
                    Flag for Review
                </button>
                <button class="action-btn">
                    <i class="fas fa-plus"></i>
                    Add Note
                </button>
            </div>
        </div>
    </div>
</div>